<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NetWorth Network</title>
  <link rel="stylesheet" href="style.css" />
  <meta name="theme-color" content="#121212" />
</head>

<body>
  <!-- Return to Dashboard Button -->
  <button id="back-to-dashboard" onclick="switchPage('dashboard-page')" style="
    display: none;
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 10px 15px;
    background-color: #00c853;
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    z-index: 999;
  ">Return to Dashboard</button>

  <div class="container">
    <!-- Auth Page -->
    <div id="auth-page" class="page" style="display:block; opacity:1">
      <h1>NetWorth Network</h1>
      <img src="images/logo.jpeg" alt="NetWorth Network Logo"
           style="max-width: 200px; margin: 10px auto; display: block;" />
      <div class="tab-buttons">
        <button class="tab active" onclick="toggleAuth('login')">Login</button>
        <button class="tab" onclick="toggleAuth('signup')">Sign Up</button>
      </div>
      <div id="login-form">
        <input type="email" id="login-email" placeholder="Email" required>
        <input type="password" id="login-password" placeholder="Password" required>
        <button onclick="login()">Login</button>
      </div>
      <div id="signup-form" class="hidden">
        <input type="text" id="signup-name" placeholder="Full Name" required>
        <input type="email" id="signup-email" placeholder="Email" required>
        <input type="password" id="signup-password" placeholder="Password" required>
        <button onclick="signup()">Sign Up</button>
      </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard-page" class="page">
      <h2>Welcome to Your Dashboard</h2>
      <div class="tab-buttons">
        <button class="tab" onclick="switchPage('dashboard-page')">Home</button>
        <button class="tab" onclick="switchPage('wallet')">Wallet</button>
        <button class="tab" onclick="switchPage('transactions')">Transactions</button>
        <button class="tab" onclick="switchPage('market-insights')">Market Insights</button>
      </div>

      <h3>Live Cryptocurrency Prices</h3>
      <table id="crypto-table">
        <thead><tr><th>Name</th><th>Price</th><th>Change</th></tr></thead>
        <tbody id="crypto-table-body"><tr><td colspan="3">Loading data...</td></tr></tbody>
      </table>
    </div>

    <!-- Wallet -->
    <div id="wallet" class="page">
      <h2>Your Wallet</h2>
      <form>
        <label>Select Cryptocurrency:</label>
        <select id="wallet-crypto">
          <option>Bitcoin</option>
          <option>Ethereum</option>
          <option>Cardano</option>
        </select>
        <input id="wallet-amount" type="number" placeholder="Amount">
        <label>Select Payment Method:</label>
        <select>
          <option>Apple Pay</option>
          <option>Google Pay</option>
          <option>Wire Transfer</option>
          <option>Credit Card</option>
        </select>
        <button type="button" onclick="startPayment()">Buy</button>
        <button type="button">Sell</button>
      </form>
    </div>

    <!-- Payment Page -->
    <div id="payment-page" class="page">
      <h2>Enter Payment Information</h2>
      <form onsubmit="processPayment(event)">
        <input type="text" placeholder="Cardholder Name" required />
        <input type="text" placeholder="Card Number" maxlength="19" required />
        <div style="display: flex; gap: 10px;">
          <input type="text" placeholder="MM/YY" maxlength="5" required style="flex: 1;" />
          <input type="text" placeholder="CVV" maxlength="4" required style="flex: 1;" />
        </div>
        <input type="text" placeholder="Billing ZIP Code" maxlength="10" required />
        <button type="submit">Submit Payment</button>
        <button type="button" onclick="switchPage('wallet')">Back to Wallet</button>
      </form>
    </div>

    <!-- Confirmation Page -->
    <div id="confirmation-page" class="page">
      <h2>Payment Confirmed âœ…</h2>
      <p>Thank you! Your transaction has been successfully processed.</p>
      <button onclick="switchPage('dashboard-page')">Return to Dashboard</button>
    </div>

    <!-- Transactions -->
    <div id="transactions" class="page">
      <h2>Transaction History</h2>
      <table>
        <thead>
          <tr><th>Date</th><th>Type</th><th>Amount</th><th>Status</th></tr>
        </thead>
        <tbody id="transactions-table-body">
          <!-- Populated by JS -->
        </tbody>
      </table>
    </div>

    <!-- Market Insights -->
    <div id="market-insights" class="page">
      <h2>Market Insights</h2>
      <p>Bitcoin is seeing a rise due to increased institutional interest. Ethereum is stabilizing post-update. Cardano's upcoming fork could affect prices.</p>
    </div>
  </div>

  <script>
    function toggleAuth(type) {
      const loginForm = document.getElementById("login-form");
      const signupForm = document.getElementById("signup-form");
      if (type === "login") {
        loginForm.classList.remove("hidden");
        signupForm.classList.add("hidden");
      } else {
        signupForm.classList.remove("hidden");
        loginForm.classList.add("hidden");
      }
    }

    function signup() {
      const name = document.getElementById("signup-name").value;
      const email = document.getElementById("signup-email").value;
      const password = document.getElementById("signup-password").value;
      if (email && password) {
        localStorage.setItem("user", JSON.stringify({ name, email, password }));
        alert("Sign up successful! Please login.");
        toggleAuth('login');
      } else {
        alert("Please fill in all fields.");
      }
    }

    function login() {
      const email = document.getElementById("login-email").value;
      const password = document.getElementById("login-password").value;
      const user = JSON.parse(localStorage.getItem("user"));
      if (user && user.email === email && user.password === password) {
        enterApp();
      } else {
        alert("Invalid email or password");
      }
    }

    function enterApp() {
      switchPage('dashboard-page');
      fetchCryptoPrices();
    }

    function switchPage(pageId) {
      const pages = document.querySelectorAll('.page');
      pages.forEach(page => {
        page.style.display = 'none';
        page.style.opacity = 0;
      });
      const activePage = document.getElementById(pageId);
      activePage.style.display = 'block';
      setTimeout(() => { activePage.style.opacity = 1; }, 10);

      // Show/hide dashboard button
      const backBtn = document.getElementById("back-to-dashboard");
      backBtn.style.display = (pageId === "dashboard-page") ? "none" : "block";

      if (pageId === "transactions") {
        loadTransactions();
      }
    }

    async function fetchCryptoPrices() {
      const apiUrl = "https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,binancecoin,solana,matic-network&vs_currencies=usd&include_24hr_change=true";
      try {
        const response = await fetch(apiUrl);
        const data = await response.json();
        const tableBody = document.getElementById("crypto-table-body");
        tableBody.innerHTML = "";
        const cryptoNames = {
          bitcoin: "Bitcoin", ethereum: "Ethereum", binancecoin: "BNB",
          solana: "Solana", "matic-network": "Polygon"
        };
        for (let id in cryptoNames) {
          if (data[id]) {
            const price = data[id].usd.toFixed(2);
            const change = data[id].usd_24h_change.toFixed(2);
            const color = change >= 0 ? "green" : "red";
            const row = document.createElement("tr");
            row.innerHTML = `
              <td>${cryptoNames[id]}</td>
              <td>$${price}</td>
              <td style="color:${color}">${change}%</td>
            `;
            tableBody.appendChild(row);
          }
        }
      } catch (error) {
        document.getElementById("crypto-table-body").innerHTML = `<tr><td colspan="3">Failed to fetch prices.</td></tr>`;
        console.error("Fetch error:", error);
      }
    }

    function startPayment() {
      const crypto = document.getElementById("wallet-crypto").value;
      const amount = document.getElementById("wallet-amount").value;

      if (!amount || amount <= 0) {
        alert("Please enter a valid amount.");
        return;
      }

      sessionStorage.setItem("pendingCrypto", crypto);
      sessionStorage.setItem("pendingAmount", amount);
      switchPage("payment-page");
    }

    function processPayment(e) {
      e.preventDefault();
      const crypto = sessionStorage.getItem("pendingCrypto");
      const amount = sessionStorage.getItem("pendingAmount");

      const transaction = {
        date: new Date().toISOString().split("T")[0],
        type: "Buy",
        amount: `${amount} ${crypto}`,
        status: "Completed"
      };

      let transactions = JSON.parse(localStorage.getItem("transactions")) || [];
      transactions.push(transaction);
      localStorage.setItem("transactions", JSON.stringify(transactions));

      switchPage('confirmation-page');
    }

    function loadTransactions() {
      const tableBody = document.getElementById("transactions-table-body");
      tableBody.innerHTML = "";
      const transactions = JSON.parse(localStorage.getItem("transactions")) || [];

      if (transactions.length === 0) {
        tableBody.innerHTML = `<tr><td colspan="4">No transactions yet.</td></tr>`;
        return;
      }

      transactions.forEach(tx => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${tx.date}</td>
          <td>${tx.type}</td>
          <td>${tx.amount}</td>
          <td>${tx.status}</td>
        `;
        tableBody.appendChild(row);
      });
    }
  </script>

  <style>
    .hidden { display: none; }
    .tab.active { font-weight: bold; }
    .page { display: none; opacity: 0; transition: opacity 0.3s ease; }
  </style>
</body>
</html>
